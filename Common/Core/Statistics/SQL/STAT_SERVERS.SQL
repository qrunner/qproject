-- создаем таблицу для хранения списка серверов
CREATE TABLE SOZ_STAT_SERVERS (
  ID NUMBER(10) NOT NULL,
  NAME VARCHAR2(150 CHAR) NOT NULL,
  CONSTRAINT PK_SOZ_STAT_SERVERS PRIMARY KEY (ID))
TABLESPACE DIA_DATA
STORAGE (
  INITIAL 64K
  MAXEXTENTS UNLIMITED
)
LOGGING;

CREATE UNIQUE INDEX UK_SOZ_STAT_SERVERS_NAME ON SOZ_STAT_SERVERS (NAME)
TABLESPACE DIA_DATA
STORAGE (
  INITIAL 64K
  MAXEXTENTS UNLIMITED
)
LOGGING;

COMMENT ON COLUMN SOZ_STAT_SERVERS.ID IS 'Server identifier';
COMMENT ON COLUMN SOZ_STAT_SERVERS.NAME IS 'Server name or IP';

-- создаем последовательность для генерации ID
CREATE SEQUENCE SOZ_STAT_SERVERS_SQ
  START WITH 1
  INCREMENT BY 1;

-- создаем триггер для генерации ID
CREATE OR REPLACE TRIGGER SOZ_STAT_SERVERS_TRG_BEF_INS
BEFORE INSERT ON SOZ_STAT_SERVERS FOR EACH ROW
BEGIN
 IF :new.ID IS NULL THEN
		SELECT SOZ_STAT_SERVERS_SQ.nextval INTO :new.ID FROM DUAL;
	END IF;
END;